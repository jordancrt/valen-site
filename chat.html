<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="assets/style.css" />
  <title>ValenHub — Chat IA</title>
  <style>.chat{display:flex;flex-direction:column;gap:12px}.msg{padding:10px;border:1px solid rgba(255,255,255,.15);border-radius:10px}</style>
</head>
<body>
  <nav class="nav">
    <div class="brand"><div class="logo"></div><h1>VALENHUB</h1></div>
    <div class="links">
      <a href="/">Accueil</a>
      <a href="dashboard.html">Tableau</a>
      <a href="chat.html" class="btn">Chat IA</a>
      <a href="about.html">À propos</a>
    </div>
  </nav>

  <section class="container chat">
    <h2>Assistant IA (éducation financière)</h2>
    <div id="log"></div>
    <div class="inputbar">
      <input id="q" placeholder="Pose ta question (budget, concepts, outils)…" />
      <button id="send" class="btn">Envoyer</button>
    </div>
    <small class="muted">L’IA donne des réponses éducatives. Pas de conseil financier personnalisé.</small>
  </section>

  <script>
    const log = document.getElementById('log');
    function add(role, text){
      const div = document.createElement('div');
      div.className = 'msg ' + (role==='user'?'me':'ai');
      div.textContent = (role==='user'?'Moi: ':'Valen IA: ') + text;
      log.prepend(div);
    }
    async function ask(){
      const q = document.getElementById('q').value.trim();
      if(!q) return;
      add('user', q);
      document.getElementById('q').value='';
      try{
        const r = await fetch('/.netlify/functions/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({prompt:q,system:'Sois pédagogique, prudent et bienveillant. Pas de conseils personnalisés.'})});
        const data = await r.json();
        add('ai', data.reply || '…');
      }catch(e){ add('ai','Erreur réseau.'); }
    }
    document.getElementById('send').onclick = ask;
    document.getElementById('q').addEventListener('keydown',e=>{ if(e.key==='Enter') ask(); });
  </script>
</body>
</html>
